<html>
    <head>
        <title>Client</title> 
        <meta name="viewport" content="width=device-width, initial-scale=1">              
        <link rel="stylesheet" 
        href="https://www.w3schools.com/w3css/4/w3.css">


    </head>
    <body>

        <div class="w3-row">
            <div class="w3-col w3-mobile w3-container w3-indigo"">
                <h5>Teszt oldal</h5>
            </div>
        </div>

        <div class="w3-row-padding">
            <div class="w3-col w3-mobile s4 w3-container w3-display-middle" style="margin: 10px;">
                <div class="w3-card-4">
                    <img class="w3-center" id= "frame" src="" alt="A kamera nem elérhető" style="width: 100%;">
                    <div class="w3-card4 w3-container w3-left">
                    </div>
                    <div class="w3-container w3-center">
                        <p>ESP32-Cam OV2640
                            <span class="w3-right" id="msglen" style="font-size: 8pt;">Msg len: 0</span>
                        </p>
                    </div>
                </div> 
            </div>
        </div>
        <div class="w3-row">
            <div class="w3-col w3-mobile w3-container w3-display-bottommiddle w3-indigo">
                <h5 class="w3-right" id="date"></h5>
            </div>
        </div>

        <script>
            const img = document.getElementById("frame");
            const dateTxt = document.getElementById("date");
            const msglen = document.getElementById("msglen");

            const dateObj = new Date();
            const month = dateObj.getUTCMonth() + 1;
            const day = dateObj.getUTCDate();
            const year = dateObj.getUTCFullYear();

            if(month < 10)
            {
                dateTxt.innerHTML = year + ".0" + month + "." + day+ ".";
            }
            else
            {
                dateTxt.innerHTML = year + "." + month + "." + day+ ".";
            }

            const WS_URL = 'ws:///192.168.1.75:8888';
            const url = "data:image/png;base64, ";
            var msgl = 0
            ;
            const ws = new WebSocket(WS_URL);
            ws.onopen = () => console.log(`Connected to ${WS_URL}`);
                ws.onmessage = message => {            
                img.src =url+ message.data;
                msgl = 4*Math.ceil(message.data.length / 3.0);
                msglen.innerHTML = "Msg len: " + msgl + "B";
                }
        </script>
    </body>
</html>

